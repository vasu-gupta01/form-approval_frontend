(this["webpackJsonpform-approval"]=this["webpackJsonpform-approval"]||[]).push([[0],{29:function(e,t,a){},31:function(e,t){e.exports={ADDR:""}},45:function(e,t){},53:function(e,t,a){},76:function(e,t){},77:function(e,t){},84:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a.n(s),n=a(21),l=a.n(n),r=a(7),i=(a(53),a(9)),o=a(10),d=a(14),j=a(13),m=(a(23),a(5)),b=a(15),h=a.n(b),u=a(31),O=a.n(u).a.ADDR+"/api/auth/",x=new(function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"login",value:function(e,t){return h.a.post(O+"signin",{username:e,password:t}).then((function(e){return e.data.accessToken&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))}},{key:"logout",value:function(){localStorage.removeItem("user")}},{key:"register",value:function(e,t,a,s,c){return h.a.post(O+"signup",{username:e,firstname:t,lastname:a,role:s,password:c})}},{key:"getCurrentUser",value:function(){return JSON.parse(localStorage.getItem("user"))}}]),e}()),v=(a(29),a(20)),p=a(19),f=a(8);function g(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}var N=new(function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"getApprovalRequests",value:function(){return h.a.get("/api/getapprovalrequests",{headers:g()})}},{key:"getUsers",value:function(){return h.a.get("/api/getapprovers",{headers:g()})}},{key:"getRoles",value:function(){return h.a.get("/api/getroles",{headers:g()})}},{key:"getDepartments",value:function(){return h.a.get("/api/getdepartments",{headers:g()})}},{key:"updateApproval",value:function(e){return h.a.post("/api/updateapproval",e,{headers:g()})}},{key:"updateApprover",value:function(e){return h.a.post("/api/approver/update",e,{headers:g()})}},{key:"updateRole",value:function(e){return h.a.post("/api/role/update",e,{headers:g()})}},{key:"createRole",value:function(e){return h.a.post("/api/createrole",e,{headers:g()})}},{key:"createDepartment",value:function(e){return h.a.post("/api/createdepartment",e,{headers:g()})}},{key:"getApprovalRequest",value:function(e){return h.a.post("/api/getapprovalrequest",e,{headers:g()})}}]),e}()),y=a(0);function w(){return Object(y.jsx)("div",{className:"d-flex justify-content-center text-center text-light",children:Object(y.jsxs)("div",{className:"row",children:[Object(y.jsx)("div",{className:"col-12 mb-2",children:Object(y.jsx)("div",{className:"spinner-border",role:"status",children:Object(y.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}),Object(y.jsx)("div",{className:"col-12",children:Object(y.jsx)("strong",{className:"",children:"Loading..."})})]})})}var C=a(47),k=a(32),S=function(e){var t=e.apiData,a=e.fileName;return Object(y.jsx)("button",{className:"btn btn-outline-success",onClick:function(e){return function(e,t){var a={Sheets:{data:k.utils.json_to_sheet(e)},SheetNames:["data"]},s=k.write(a,{bookType:"xlsx",type:"array"}),c=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});C.saveAs(c,t+".xlsx")}(t,a)},children:"Export to Excel"})},_=a(25),A=a.n(_);function D(e,t){var a,s=new Date(e);return a=t.getTime()-s.getTime(),Math.floor(a/864e5)}function q(e){return e.forms?0!==e.forms.length?Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"row mb-3 ms-1 me-1 mt-5",children:[Object(y.jsxs)("div",{className:"form-check form-switch col-6",children:[Object(y.jsx)("label",{className:"form-check-label text-light h5 ms-1",htmlFor:"flexSwitchCheckDefault",children:"Show all"}),Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",onChange:e.handleShowAll})]}),Object(y.jsx)("div",{className:"col-6 text-end",children:Object(y.jsx)(S,{apiData:U(e.forms),fileName:"myfile"})})]}),Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.forms.slice(0).reverse().map((function(t){return Object(y.jsxs)(r.b,{to:"/form/"+t._id,className:"list-group-item list-group-item-action",style:{display:e.showAll||t.show?"block":"none"},children:[Object(y.jsxs)("div",{className:"d-flex w-100 justify-content-between",children:[Object(y.jsx)("h5",{className:"mb-2",children:t.filled_by}),Object(y.jsx)("small",{children:t.date_submitted?D(t.date_submitted,new Date)+" days ago":""})]},"div_"+t._id),Object(y.jsx)("p",{className:"mb-2",children:t.form.name}),L(t.approval).map((function(e){return Object(y.jsx)("span",{className:"badge rounded-pill mb-1 me-2 "+e.status,children:e.message})}))]},"Link_"+t._id)}))})]}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No requests to show."})}):Object(y.jsx)(w,{})}function U(e){var t,a=[],s=Object(p.a)(e);try{for(s.s();!(t=s.n()).done;){var c,n=t.value,l=[],r=[],i=Object(p.a)(n.approval);try{for(i.s();!(c=i.n()).done;){var o=c.value;1===o.status?l.push(o.approver.firstname):2===o.status&&r.push(o.approver.firstname)}}catch(j){i.e(j)}finally{i.f()}var d={"Filled By":n.filled_by,"Form Type":n.form.name,"Approved By":"".concat(l),"Dissaproved By":"".concat(r),"Date Filled":A()(n.date_submitted).format("DD/MM/YYYY - h:mm A")};a.push(d)}}catch(j){s.e(j)}finally{s.f()}return a}function L(e){var t,a=[],s=Object(p.a)(e);try{for(s.s();!(t=s.n()).done;){var c=t.value;1===c.status?a.push({status:"bg-success",message:c.approver.firstname+" Approved"}):2===c.status&&a.push({status:"bg-danger",message:c.approver.firstname+" Disapproved"})}}catch(n){s.e(n)}finally{s.f()}return 0===a.length&&a.push({status:"bg-warning",message:"Approval Pending"}),a}var M=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={currentUser:x.getCurrentUser(),dbRequests:[],showAll:!1},s.handleShowAll=s.handleShowAll.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getApprovalRequests().then((function(t){if(t.data){var a,s=[],c=Object(p.a)(t.data);try{for(c.s();!(a=c.n()).done;){var n,l=a.value,r=0,i=Object(p.a)(l.approval);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.approver._id===x.getCurrentUser().id&&(r+=o.status)}}catch(d){i.e(d)}finally{i.f()}0===r?s.push(Object(v.a)(Object(v.a)({},l),{},{show:!0})):s.push(Object(v.a)(Object(v.a)({},l),{},{show:!1}))}}catch(d){c.e(d)}finally{c.f()}e.setState({dbRequests:s})}})).catch()}},{key:"handleShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"render",value:function(){this.state.currentUser;return Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{className:"container-fluid",children:Object(y.jsxs)("nav",{className:"row navbar navbar-light bg-dark rounded shadow-lg",children:[Object(y.jsx)("div",{className:"col-4",children:Object(y.jsxs)("p",{className:"navbar-brand text-light mt-1",children:["Welcome, ",x.getCurrentUser().firstname,"!"]})}),Object(y.jsxs)("div",{className:"col text-end",children:[Object(y.jsx)("button",{className:"btn btn-outline-light",onClick:function(){window.location.reload()},children:"Home"}),Object(y.jsx)("button",{className:"btn btn-outline-danger ms-2",onClick:function(){x.logout(),window.location.reload()},children:"Logout"})]})]})}),Object(y.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:Object(y.jsx)(q,{forms:this.state.dbRequests,handleShowAll:this.handleShowAll,showAll:this.state.showAll})})]})}}]),a}(s.Component),R=a(4);function T(e){return e.users?0!==e.users.length?Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"row mb-3",children:[Object(y.jsx)("div",{className:"col-12 text-light",children:Object(y.jsx)("h4",{children:"Manage Users"})}),Object(y.jsx)("div",{className:"col",children:Object(y.jsx)(r.b,{to:"/mod/signup",className:"btn btn-outline-light",children:"+ Add approver"})}),Object(y.jsx)("div",{className:"col",children:Object(y.jsx)(r.b,{to:"/mod/roles",className:"btn btn-outline-light",children:"Manage Roles"})})]}),Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.users.slice(0).reverse().map((function(e){return Object(y.jsxs)(r.b,{to:{pathname:"/mod/userdetails",state:{user:e}},className:"list-group-item list-group-item-action",children:[Object(y.jsx)("div",{className:"d-flex w-100 justify-content-between"},"div_"+e._id),Object(y.jsx)("h5",{children:e.firstname+" "+e.lastname}),Object(y.jsxs)("p",{className:"mb-2",children:["Username: ",e.username]}),Object(y.jsxs)("p",{className:"mb-2",children:["Role: ",e.role.description]})]},"Link_"+e._id)}))})]}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No users to show."})}):Object(y.jsx)(w,{})}var E=function(e){var t=Object(s.useState)([]),a=Object(R.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){N.getUsers().then((function(e){e.data&&n(e.data)}))}),[]),Object(y.jsx)("div",{className:"mt-2",children:Object(y.jsx)(T,{users:c})})};var Y=function(e){var t=Object(m.g)().state.user,a=Object(s.useState)([]),c=Object(R.a)(a,2),n=c[0],l=c[1],r=Object(s.useState)(""),i=Object(R.a)(r,2),o=i[0],d=i[1],j=Object(s.useState)(""),b=Object(R.a)(j,2),h=b[0],u=b[1],O=Object(s.useState)(""),x=Object(R.a)(O,2),v=x[0],p=x[1],f=Object(s.useState)(""),g=Object(R.a)(f,2),w=g[0],C=g[1],k=Object(s.useState)(""),S=Object(R.a)(k,2),_=S[0],A=S[1],D=Object(s.useState)(!1),q=Object(R.a)(D,2),U=q[0],L=q[1],M=Object(s.useState)(!1),T=Object(R.a)(M,2),E=T[0],Y=T[1],F=Object(s.useState)(!1),P=Object(R.a)(F,2),B=P[0],H=P[1];return Object(s.useEffect)((function(){N.getRoles().then((function(e){e.data&&l(e.data)})),d(t.firstname),u(t.lastname),p(t.username),C(t.role._id)}),[]),Object(y.jsx)("div",{className:"container container-form d-flex align-items-center justify-content-center mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:function(e){e.preventDefault(),L(!0);var a={};""===v?(Y(!1),L(!1),H(!0)):(H(!1),a=""===_?{id:t._id,username:v,firstname:o,lastname:h,role:w}:{id:t._id,username:v,firstname:o,lastname:h,role:w,password:_},N.updateApprover(a).then((function(){window.location.replace("/mod/users")}),(function(e){L(!1),Y(!0)})))},children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[t.firstname," - User Details"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Firstname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:o,onChange:function(e){d(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Lastname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:h,onChange:function(e){u(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Username:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:v,onChange:function(e){p(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Role:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("select",{type:"text",className:"form-select",value:w,onChange:function(e){C(e.target.value)},children:n.map((function(e){return Object(y.jsxs)("option",{value:e._id,children:[e.name," - ",e.description]})}))})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"New Password:"}),Object(y.jsx)("div",{className:"col-sm-8",value:_,onChange:function(e){A(e.target.value)},children:Object(y.jsx)("input",{type:"password",className:"form-control"})})]}),E?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",B?Object(y.jsx)("strong",{className:"text-danger",children:"Username is required."}):""]}),Object(y.jsx)("div",{className:"card-footer",children:Object(y.jsx)("div",{className:"row",children:Object(y.jsx)("div",{className:"col-12 text-end",children:U?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Update"})})})})]})})},F=a(22);var P=function(e){return Object(y.jsx)(F.a,{show:e.show,dialogClassName:"modal-dialog-centered",children:Object(y.jsxs)("div",{className:"",children:[Object(y.jsx)(F.a.Header,{children:Object(y.jsx)(F.a.Title,{className:"text-danger bg-gradient",children:"Login failed"})}),Object(y.jsx)(F.a.Body,{children:"Please check your username/password."}),Object(y.jsx)(F.a.Footer,{as:"footer",children:Object(y.jsx)("button",{className:"btn btn-outline-dark",onClick:e.hideModal,children:"Close"})})]})})},B=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={username:"",password:"",message:"",role:"",firstname:"",lastname:"",invalidLogin:!1,roles:[]},s.handleSignup=s.handleSignup.bind(Object(f.a)(s)),s.hideModal=s.hideModal.bind(Object(f.a)(s)),s.handleChange=s.handleChange.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getRoles().then((function(t){t.data&&e.setState({roles:t.data})}))}},{key:"handleChange",value:function(e,t){var a=this.state;a[t]=e.target.value,this.setState(a)}},{key:"handleSignup",value:function(e){var t=this;e.preventDefault(),x.register(this.state.username,this.state.firstname,this.state.lastname,this.state.role,this.state.password).then((function(){window.location.replace("users")}),(function(e){t.setState({invalidLogin:!0})}))}},{key:"hideModal",value:function(){this.setState({invalidLogin:!1})}},{key:"render",value:function(){var e=this,t=this.state.roles;return Object(y.jsxs)("div",{className:"container-form mt-5",children:[Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleSignup,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Create new approver"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Username:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"username")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Password:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"password",className:"form-control",onChange:function(t){return e.handleChange(t,"password")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Firstname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"firstname")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Lastname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"lastname")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Roles:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{className:"form-select",onChange:function(t){return e.handleChange(t,"role")},children:[Object(y.jsx)("option",{selected:!0,value:"",children:"-- role --"}),t.map((function(e){return Object(y.jsxs)("option",{value:e._id,children:[e.name," - ",e.description]})}))]})})]})]}),Object(y.jsx)("div",{className:"card-footer text-end",children:Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]}),Object(y.jsx)(P,{show:this.state.invalidLogin,hideModal:this.hideModal})]})}}]),a}(s.Component);function H(e){return e.roles?0!==e.roles.length?Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"row mb-3",children:[Object(y.jsx)("div",{className:"col-12 text-light",children:Object(y.jsx)("h4",{children:"Roles"})}),Object(y.jsx)("div",{className:"col-4",children:Object(y.jsx)(r.b,{to:"/mod/roles/create",className:"btn btn-outline-light",children:"+ Add role"})}),Object(y.jsx)("div",{className:"col-6",children:Object(y.jsx)(r.b,{to:"/mod/roles/createdepartment",className:"btn btn-outline-light",children:"+ Add department"})})]}),Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.roles.slice(0).reverse().map((function(e){return Object(y.jsxs)(r.b,{to:{pathname:"/mod/role/details",state:{role:e}},className:"list-group-item list-group-item-action",children:[Object(y.jsx)("div",{className:"d-flex w-100 justify-content-between"},"div_"+e._id),Object(y.jsx)("h5",{children:e.description}),Object(y.jsxs)("p",{className:"mb-2",children:["Type: ",e.name]}),Object(y.jsxs)("p",{className:"mb-2",children:["Access Level: ",e.level]})]},"Link_"+e._id)}))})]}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No roles to show."})}):Object(y.jsx)(w,{})}var I=function(e){var t=Object(s.useState)([]),a=Object(R.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){N.getRoles().then((function(e){e.data&&n(e.data)}))}),[]),Object(y.jsx)("div",{className:"mt-2",children:Object(y.jsx)(H,{roles:c})})},J=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={type:"",description:"",department:"",level:"",clicked_create:!1,error:!1,field_missing:!1,departments:[]},s.handleCreate=s.handleCreate.bind(Object(f.a)(s)),s.handleChange=s.handleChange.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getDepartments().then((function(t){t.data&&e.setState({departments:t.data})}))}},{key:"handleChange",value:function(e,t){var a=this.state;a[t]=e.target.value,this.setState(a)}},{key:"handleCreate",value:function(e){var t=this;e.preventDefault(),this.setState({clicked_create:!0});var a=this.state.type,s=this.state.description,c=this.state.department,n=this.state.level;""===a&&""===n?(this.setState({field_missing:!0}),this.setState({clicked_create:!1})):(this.setState({field_missing:!1}),N.createRole({name:a,description:s,department:c,level:n}).then((function(){t.setState({clicked_create:!1}),window.location.replace("/mod/roles")}),(function(e){t.setState({clicked_create:!1}),t.setState({error:!0})})))}},{key:"render",value:function(){var e=this,t=this.state.departments;return Object(y.jsx)("div",{className:"container-form mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleCreate,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Create new roles"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Type:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{placeholder:"e.g. HOD",type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"type")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Description:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{placeholder:"e.g. Head of IT",type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"description")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Department:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{className:"form-select",onChange:function(t){return e.handleChange(t,"department")},children:[Object(y.jsx)("option",{selected:!0,value:"",children:"-- department --"}),t.map((function(e){return Object(y.jsx)("option",{value:e._id,children:e.name})}))]})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Access level:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{className:"form-select",onChange:function(t){return e.handleChange(t,"level")},children:[Object(y.jsx)("option",{selected:!0,value:"",children:"-- access level --"}),Object(y.jsx)("option",{value:"0",children:"level 0 -- only view"}),Object(y.jsx)("option",{value:"1",children:"level 1 -- view/approve only department requests"}),Object(y.jsx)("option",{value:"2",children:"level 2 -- view/approve all requests"})]})})]}),this.state.error?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",this.state.field_missing?Object(y.jsx)("strong",{className:"text-danger",children:"Type and Access level fields are required."}):""]}),Object(y.jsx)("div",{className:"card-footer text-end",children:this.state.clicked_create?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]})})}}]),a}(s.Component),W=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={name:"",clicked_create:!1,error:!1,field_missing:!1},s.handleCreate=s.handleCreate.bind(Object(f.a)(s)),s.handleChange=s.handleChange.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e,t){var a=this.state;a[t]=e.target.value,this.setState(a)}},{key:"handleCreate",value:function(e){var t=this;e.preventDefault(),this.setState({clicked_create:!0});var a=this.state.name;""===a?(this.setState({field_missing:!0}),this.setState({clicked_create:!1})):(this.setState({field_missing:!1}),N.createDepartment({name:a}).then((function(){t.setState({clicked_create:!1}),window.location.replace("/mod/roles")}),(function(e){t.setState({clicked_create:!1}),t.setState({error:!0})})))}},{key:"render",value:function(){var e=this;return Object(y.jsx)("div",{className:"container-form mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleCreate,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Add Department"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Name:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"name")}})})]}),this.state.error?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",this.state.field_missing?Object(y.jsx)("strong",{className:"text-danger",children:"Name field is required."}):""]}),Object(y.jsx)("div",{className:"card-footer text-end",children:this.state.clicked_create?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]})})}}]),a}(s.Component);var z=function(e){var t=Object(m.g)().state.role,a=Object(s.useState)([]),c=Object(R.a)(a,2),n=c[0],l=c[1],r=Object(s.useState)(""),i=Object(R.a)(r,2),o=i[0],d=i[1],j=Object(s.useState)(""),b=Object(R.a)(j,2),h=b[0],u=b[1],O=Object(s.useState)(""),x=Object(R.a)(O,2),v=x[0],p=x[1],f=Object(s.useState)(""),g=Object(R.a)(f,2),w=g[0],C=g[1],k=Object(s.useState)(!1),S=Object(R.a)(k,2),_=S[0],A=S[1],D=Object(s.useState)(!1),q=Object(R.a)(D,2),U=q[0],L=q[1],M=Object(s.useState)(!1),T=Object(R.a)(M,2),E=T[0],Y=T[1];return Object(s.useEffect)((function(){N.getDepartments().then((function(e){e.data&&l(e.data)})),d(t.description),u(t.name),C(t.department),p(t.level)}),[]),Object(y.jsx)("div",{className:"container container-form d-flex align-items-center justify-content-center mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:function(e){if(e.preventDefault(),A(!0),""===v&&""==h)L(!1),A(!1),Y(!0);else{Y(!1);var a={id:t._id,description:o,level:v,name:h,department:w};N.updateRole(a).then((function(){window.location.replace("/mod/roles")}),(function(e){A(!1),L(!0)}))}},children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[t.description," - Role Details"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Type:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:h,onChange:function(e){u(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Description:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:o,onChange:function(e){d(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Department:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{type:"text",className:"form-select",value:w,onChange:function(e){C(e.target.value)},children:[Object(y.jsx)("option",{value:"",children:"none"}),n.map((function(e){return Object(y.jsx)("option",{value:e._id,children:e.name})}))]})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Access Level:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{type:"text",className:"form-select",value:v,onChange:function(e){p(e.target.value)},children:[Object(y.jsx)("option",{value:"0",children:"level 0 -- only view"}),Object(y.jsx)("option",{value:"1",children:"level 1 -- view/approve only department requests"}),Object(y.jsx)("option",{value:"2",children:"level 2 -- view/approve all requests"})]})})]}),U?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",E?Object(y.jsx)("strong",{className:"text-danger",children:"Name and Access level is required."}):""]}),Object(y.jsx)("div",{className:"card-footer",children:Object(y.jsx)("div",{className:"row",children:Object(y.jsx)("div",{className:"col-12 text-end",children:_?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Update"})})})})]})})};var G=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={currentUser:x.getCurrentUser(),dbRequests:[],showAll:!1},s.handleShowAll=s.handleShowAll.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getApprovalRequests().then((function(t){if(t.data){var a,s=[],c=Object(p.a)(t.data);try{for(c.s();!(a=c.n()).done;){var n,l=a.value,r=0,i=Object(p.a)(l.approval);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.approver._id===x.getCurrentUser().id&&(r+=o.status)}}catch(d){i.e(d)}finally{i.f()}0===r?s.push(Object(v.a)(Object(v.a)({},l),{},{show:!0})):s.push(Object(v.a)(Object(v.a)({},l),{},{show:!1}))}}catch(d){c.e(d)}finally{c.f()}e.setState({dbRequests:s})}})).catch()}},{key:"handleShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"render",value:function(){this.state.currentUser;return Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{className:"container-fluid",children:Object(y.jsxs)("nav",{className:"row navbar navbar-light bg-dark rounded shadow-lg",children:[Object(y.jsx)("div",{className:"col-4",children:Object(y.jsxs)("p",{className:"navbar-brand text-light mt-1",children:["Welcome, ",x.getCurrentUser().firstname,"!"]})}),Object(y.jsxs)("div",{className:"col text-end",children:[Object(y.jsx)(r.b,{className:"btn btn-outline-light",to:"/",children:"Home"}),Object(y.jsx)(r.b,{to:"/mod/users",className:"btn btn-outline-info ms-2",children:"Manage Approvers"}),Object(y.jsx)("button",{className:"btn btn-outline-info ms-2",children:"Review Approval Requests"}),Object(y.jsx)("button",{className:"btn btn-outline-danger ms-2",onClick:function(){x.logout(),window.location.replace("/")},children:"Logout"})]})]})}),Object(y.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:Object(y.jsxs)(m.c,{children:[Object(y.jsx)(m.a,{exact:!0,path:"/mod/userdetails",component:function(){return Object(y.jsx)(Y,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/mod/role/details",component:function(){return Object(y.jsx)(z,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/mod/signup",component:function(){return Object(y.jsx)(B,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/mod/users",component:function(){return Object(y.jsx)(E,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/mod/roles",component:function(){return Object(y.jsx)(I,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/mod/roles/create",component:function(){return Object(y.jsx)(J,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/mod/roles/createdepartment",component:function(){return Object(y.jsx)(W,{})}})]})})]})}}]),a}(s.Component);var K=function(e){var t=Object(m.f)(),a=Object(m.h)().id,c=Object(s.useState)([]),n=Object(R.a)(c,2),l=n[0],r=n[1],i=Object(s.useState)(""),o=Object(R.a)(i,2),d=o[0],j=o[1],b=Object(s.useState)(!1),h=Object(R.a)(b,2),u=h[0],O=h[1],v=Object(s.useState)(0),p=Object(R.a)(v,2),f=p[0],g=p[1],C=Object(s.useState)(""),k=Object(R.a)(C,2),S=k[0],_=k[1];return Object(s.useEffect)((function(){var e=!0,t={id:a,approver:x.getCurrentUser().id};return N.getApprovalRequest(t).then((function(t){t.data&&e&&(r(t.data),t.data.date_submitted&&j(A()(t.data.date_submitted).format("DD/MM/YYYY - h:mm A")),t.data.approval?0===t.data.approval.status?(O(!1),g(0),console.log("Form not approved")):(O(!0),g(t.data.approval.status),_(t.data.approval.comments),console.log("Form already approved!")):(g(-1),console.log("MOD")))})).catch((function(e){return console.log(e)})),function(){e=!1}}),[a],[u],[l]),0===l.length?Object(y.jsx)(w,{}):Object(y.jsxs)("div",{className:"container-fluid",children:[Object(y.jsxs)("nav",{className:"row navbar navbar-light bg-dark rounded shadow-lg",children:[Object(y.jsx)("div",{className:"col-4 text-light",children:Object(y.jsxs)("p",{className:"navbar-brand text-light mt-1",children:["Welcome, ",x.getCurrentUser().firstname,"!"]})}),Object(y.jsxs)("div",{className:"col text-end",children:[Object(y.jsx)("button",{className:"btn btn-outline-light",onClick:function(){t.push("/")},children:"Home"}),Object(y.jsx)("button",{className:"btn btn-outline-danger ms-2",onClick:function(){x.logout(),t.push("/"),window.location.reload()},children:"Logout"})]})]}),Object(y.jsx)("div",{className:"container d-flex align-items-center justify-content-center mt-5",children:Object(y.jsx)("div",{className:"container-form",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[l.form.name," - Approval Request"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Employee Name:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:l.filled_by,readOnly:!0})})]}),l.fields.map((function(e){return Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsxs)("label",{className:"col-sm-4 col-form-label",children:[e.name,":"]},"label_"+e._id),Object(y.jsx)("div",{className:"col-sm-8",children:"Time Out"===e.name?Object(y.jsx)("input",{type:"text",className:"form-control",value:A()(e.value).format("DD/MM/YYYY - h:mm A"),readOnly:!0},e._id):Object(y.jsx)("input",{type:"text",className:"form-control",value:e.value,readOnly:!0},e._id)})]},"div_"+e._id)})),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Date filled:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:d,readOnly:!0})})]})]}),-1!=f?u?Object(y.jsxs)("div",{className:"card-footer row",children:[Object(y.jsxs)("p",{className:"lead m-2 text-center mb-3",children:["This approval request was"," ",1===f?Object(y.jsx)("strong",{className:"text-success",children:"approved "}):Object(y.jsx)("strong",{className:"text-danger",children:"disapproved "}),"by you."]}),Object(y.jsx)("label",{className:"col-sm-4 col-form-label mb-3",children:"Comments:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:S,readOnly:!0})})]}):Object(y.jsxs)("div",{className:"card-footer",children:[Object(y.jsxs)("div",{className:"form-floating mb-3",children:[Object(y.jsx)("textarea",{className:"form-control",placeholder:"comments",id:"floatingTextarea",style:{height:"100px","max-height":"100px"},onChange:function(e){_(e.target.value)}}),Object(y.jsx)("label",{className:"text-muted",htmlFor:"floatingTextarea",children:"Leave a comment here"})]}),Object(y.jsxs)("div",{className:"row",children:[Object(y.jsx)("div",{className:"col-6 text-left",children:Object(y.jsx)("button",{className:"btn btn-outline-danger",onClick:function(e){e.preventDefault();var t={request_id:a,approver:x.getCurrentUser().id,action:2,comments:S};console.log(t),N.updateApproval(t).then((function(){O(!0),g(2)}))},children:"Disapprove"})}),Object(y.jsx)("div",{className:"col-6 text-end",children:Object(y.jsx)("button",{className:"btn btn-outline-success",onClick:function(e){e.preventDefault();var t={request_id:a,approver:x.getCurrentUser().id,action:1,comments:S};N.updateApproval(t).then((function(){O(!0),g(1)}))},children:"Approve"})})]})]}):Object(y.jsx)("div",{children:" MOD"})]})})})]})},Q=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={username:"",password:"",message:"",invalidLogin:!1},s.handleLogin=s.handleLogin.bind(Object(f.a)(s)),s.onChangeUsername=s.onChangeUsername.bind(Object(f.a)(s)),s.onChangePassword=s.onChangePassword.bind(Object(f.a)(s)),s.hideModal=s.hideModal.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleLogin",value:function(e){var t=this;e.preventDefault(),x.login(this.state.username,this.state.password).then((function(){window.location.reload()}),(function(e){t.setState({invalidLogin:!0})}))}},{key:"hideModal",value:function(){this.setState({invalidLogin:!1})}},{key:"render",value:function(){return Object(y.jsxs)("div",{className:"container-form",children:[Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleLogin,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Login"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Username:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:this.onChangeUsername})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Password:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"password",className:"form-control",onChange:this.onChangePassword})})]})]}),Object(y.jsx)("div",{className:"card-footer text-end",children:Object(y.jsx)("button",{className:"btn btn-primary",children:"Login"})})]}),Object(y.jsx)(P,{show:this.state.invalidLogin,hideModal:this.hideModal})]})}}]),a}(s.Component),V=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).state={currentUser:null},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=x.getCurrentUser();e&&this.setState({currentUser:e})}},{key:"render",value:function(){var e=this.state.currentUser;return e?e&&e.role.level?3===e.role.level?Object(y.jsx)("div",{className:"",children:Object(y.jsxs)(m.c,{children:[Object(y.jsx)(m.a,{path:"/",component:function(){return Object(y.jsx)(G,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/form/:id",component:function(){return Object(y.jsx)(K,{})}})]})}):Object(y.jsx)("div",{className:"",children:Object(y.jsxs)(m.c,{children:[Object(y.jsx)(m.a,{exact:!0,path:"/",component:function(){return Object(y.jsx)(M,{})}}),Object(y.jsx)(m.a,{exact:!0,path:"/form/:id",component:function(){return Object(y.jsx)(K,{})}})]})}):void 0:Object(y.jsx)("div",{className:"App-Container container d-flex align-items-center justify-content-center",children:Object(y.jsx)(Q,{})})}}]),a}(s.Component);l.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(r.a,{children:Object(y.jsx)(V,{})})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.99b19192.chunk.js.map