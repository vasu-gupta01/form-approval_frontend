(this["webpackJsonpform-approval"]=this["webpackJsonpform-approval"]||[]).push([[0],{121:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a.n(s),n=a(24),l=a.n(n),r=a(7),i=a(8),o=(a(68),a(10)),d=a(11),j=a(14),m=a(13),b=(a(26),a(12)),h=a.n(b),u=a(42),O=a.n(u).a.ADDR+"/api/auth/",x=new(function(){function e(){Object(o.a)(this,e)}return Object(d.a)(e,[{key:"login",value:function(e,t){return h.a.post(O+"signin",{username:e,password:t}).then((function(e){return e.data.accessToken&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))}},{key:"logout",value:function(){localStorage.removeItem("user")}},{key:"register",value:function(e,t,a,s,c){return h.a.post(O+"signup",{username:e,firstname:t,lastname:a,role:s,password:c})}},{key:"getCurrentUser",value:function(){return JSON.parse(localStorage.getItem("user"))}}]),e}()),f=(a(32),a(16)),p=a(18),v=a(6);function g(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}var N=new(function(){function e(){Object(o.a)(this,e)}return Object(d.a)(e,[{key:"getDateRequests",value:function(e){return h.a.post("/api/dashapprovalrequests",e,{headers:g()})}},{key:"getApprovalRequests",value:function(e){return h.a.post("/api/getapprovalrequests",e,{headers:g()})}},{key:"getUsers",value:function(){return h.a.get("/api/getapprovers",{headers:g()})}},{key:"getApprovers",value:function(){return h.a.get("/api/getapproverswithoutmod",{headers:g()})}},{key:"getRoles",value:function(){return h.a.get("/api/getroles",{headers:g()})}},{key:"getDepartments",value:function(){return h.a.get("/api/getdepartments",{headers:g()})}},{key:"updateApproval",value:function(e){return h.a.post("/api/updateapproval",e,{headers:g()})}},{key:"updateApprover",value:function(e){return h.a.post("/api/approver/update",e,{headers:g()})}},{key:"updateRole",value:function(e){return h.a.post("/api/role/update",e,{headers:g()})}},{key:"createRole",value:function(e){return h.a.post("/api/createrole",e,{headers:g()})}},{key:"createDepartment",value:function(e){return h.a.post("/api/createdepartment",e,{headers:g()})}},{key:"createForm",value:function(e){return h.a.post("/api/createform",e,{headers:g()})}},{key:"getApprovalRequest",value:function(e){return h.a.post("/api/getapprovalrequest",e,{headers:g()})}},{key:"getForms",value:function(){return h.a.get("/api/getforms",{headers:g()})}},{key:"getFieldTypes",value:function(){return h.a.get("/api/getfieldtypes",{headers:g()})}},{key:"updateForm",value:function(e){return h.a.post("/api/updateform",e,{headers:g()})}}]),e}()),y=a(0);function w(){return Object(y.jsx)("div",{className:"d-flex justify-content-center text-center text-light",children:Object(y.jsxs)("div",{className:"row",children:[Object(y.jsx)("div",{className:"col-12 mb-2",children:Object(y.jsx)("div",{className:"spinner-border",role:"status",children:Object(y.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}),Object(y.jsx)("div",{className:"col-12",children:Object(y.jsx)("strong",{className:"",children:"Loading..."})})]})})}var C=a(62),k=a(43),D=function(e){var t=e.apiData,a=e.fileName;return Object(y.jsx)("button",{className:"btn btn-outline-success",onClick:function(e){return function(e,t){var a={Sheets:{data:k.utils.json_to_sheet(e)},SheetNames:["data"]},s=k.write(a,{bookType:"xlsx",type:"array"}),c=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});C.saveAs(c,t+".xlsx")}(t,a)},children:"Export to Excel"})},S=a(23),_=a.n(S),F=a(27),A=a.n(F);function q(e,t){var a,s=new Date(e);return a=t.getTime()-s.getTime(),Math.floor(a/864e5)}function T(e){return Object(y.jsxs)("div",{className:"row",children:[Object(y.jsxs)("div",{className:"col-sm-6 col-md-6 col-lg-5 mb-1",children:[Object(y.jsx)("div",{children:Object(y.jsx)("label",{className:"form-label text-light h5 me-1",children:"From:"})}),Object(y.jsx)(A.a,{disableClock:!0,maxDate:e.toDate,value:e.fromDate,onChange:function(t){t.setHours(0,0,0,0),e.setDateChange(t,e.toDate)},format:"dd/MM/yyyy"})]}),Object(y.jsxs)("div",{className:"col-sm-6 col-md-6 col-lg-5 mb-1",children:[Object(y.jsx)("div",{children:Object(y.jsx)("label",{className:"form-label text-light h5 me-1",children:"To:"})}),Object(y.jsx)(A.a,{disableClock:!0,maxDate:new Date,value:e.toDate,onChange:function(t){t.setHours(23,59,59,0),e.setDateChange(e.fromDate,t)},format:"dd/MM/yyyy"})]}),Object(y.jsx)("div",{className:"col-md-2 col-lg-2 mt-lg-4",children:Object(y.jsx)("button",{className:"btn btn-outline-light",onClick:e.handleDateChange,children:"Show"})})]})}function M(e){return e.forms?0!==e.forms.length?Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"row mb-3 ms-1 me-1 mt-5",children:[Object(y.jsxs)("div",{className:"form-check form-switch col-6",children:[Object(y.jsx)("label",{className:"form-check-label text-light h5 ms-1",htmlFor:"flexSwitchCheckDefault",children:"Show all"}),Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",onChange:e.handleShowAll})]}),Object(y.jsx)("div",{className:"col-6",children:Object(y.jsx)(D,{apiData:R(e.forms),fileName:"myfile"})})]}),Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.forms.slice(0).reverse().map((function(t){return Object(y.jsxs)(r.b,{to:"/form/"+t._id,className:"list-group-item list-group-item-action",style:{display:e.showAll||t.show?"block":"none"},children:[Object(y.jsxs)("div",{className:"d-flex w-100 justify-content-between",children:[Object(y.jsx)("h5",{className:"mb-2",children:t.filled_by}),Object(y.jsx)("small",{children:t.date_submitted?q(t.date_submitted,new Date)+" days ago":""})]},"div_"+t._id),Object(y.jsx)("p",{className:"mb-2",children:t.form.name}),L(t.approval).map((function(e){return Object(y.jsx)("span",{className:"badge rounded-pill mb-1 me-2 "+e.status,children:e.message})}))]},"Link_"+t._id)}))})]}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No requests to show."})}):Object(y.jsx)(w,{})}function R(e){var t,a=[],s=Object(p.a)(e);try{for(s.s();!(t=s.n()).done;){var c,n=t.value,l=[],r=[],i=Object(p.a)(n.approval);try{for(i.s();!(c=i.n()).done;){var o=c.value;1===o.status?l.push(o.approver.firstname):2===o.status&&r.push(o.approver.firstname)}}catch(j){i.e(j)}finally{i.f()}var d={"Filled By":n.filled_by,"Form Type":n.form.name,"Approved By":"".concat(l),"Dissaproved By":"".concat(r),"Date Filled":_()(n.date_submitted).format("DD/MM/YYYY - h:mm A")};a.push(d)}}catch(j){s.e(j)}finally{s.f()}return a}function L(e){var t,a=[],s=Object(p.a)(e);try{for(s.s();!(t=s.n()).done;){var c=t.value;1===c.status?a.push({status:"bg-success",message:c.approver.firstname+" Approved"}):2===c.status&&a.push({status:"bg-danger",message:c.approver.firstname+" Disapproved"})}}catch(n){s.e(n)}finally{s.f()}return 0===a.length&&a.push({status:"bg-warning",message:"Approval Pending"}),a}var U=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;Object(o.a)(this,a),s=t.call(this,e);var c=new Date;return c.setHours(0,0,0,0),s.state={currentUser:x.getCurrentUser(),dbRequests:[],showAll:!1,fromDate:c,toDate:new Date},s.handleShowAll=s.handleShowAll.bind(Object(v.a)(s)),s.handleDateChange=s.handleDateChange.bind(Object(v.a)(s)),s.setDateChange=s.setDateChange.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.getRequests()}},{key:"getRequests",value:function(){var e=this;N.getApprovalRequests({min_date:this.state.fromDate,max_date:this.state.toDate}).then((function(t){if(t.data){var a,s=[],c=Object(p.a)(t.data);try{for(c.s();!(a=c.n()).done;){var n,l=a.value,r=0,i=Object(p.a)(l.approval);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.approver._id===x.getCurrentUser().id&&(r+=o.status)}}catch(d){i.e(d)}finally{i.f()}0===r?s.push(Object(f.a)(Object(f.a)({},l),{},{show:!0})):s.push(Object(f.a)(Object(f.a)({},l),{},{show:!1}))}}catch(d){c.e(d)}finally{c.f()}e.setState({dbRequests:s})}})).catch()}},{key:"handleShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"handleDateChange",value:function(){this.getRequests()}},{key:"setDateChange",value:function(e,t){this.setState({fromDate:e,toDate:t})}},{key:"render",value:function(){this.state.currentUser;return Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{className:"container-fluid",children:Object(y.jsxs)("nav",{className:"row navbar navbar-light bg-dark rounded shadow-lg",children:[Object(y.jsx)("div",{className:"col-4",children:Object(y.jsxs)("p",{className:"navbar-brand text-light mt-1",children:["Welcome, ",x.getCurrentUser().firstname,"!"]})}),Object(y.jsxs)("div",{className:"col text-end",children:[Object(y.jsx)("button",{className:"btn btn-outline-light",onClick:function(){window.location.reload()},children:"Home"}),Object(y.jsx)("button",{className:"btn btn-outline-danger ms-2",onClick:function(){x.logout(),window.location.reload()},children:"Logout"})]})]})}),Object(y.jsx)("div",{className:"container d-flex align-items-center justify-content-center",children:Object(y.jsx)(T,{fromDate:this.state.fromDate,toDate:this.state.toDate,handleDateChange:this.handleDateChange,setDateChange:this.setDateChange})}),Object(y.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:Object(y.jsx)(M,{forms:this.state.dbRequests,handleShowAll:this.handleShowAll,showAll:this.state.showAll})})]})}}]),a}(s.Component),Y=a(5);function E(e){return e.users?0!==e.users.length?Object(y.jsx)("div",{children:Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.users.slice(0).reverse().map((function(e){return Object(y.jsxs)(r.b,{to:{pathname:"/mod/userdetails",state:{user:e}},className:"list-group-item list-group-item-action",children:[Object(y.jsx)("div",{className:"d-flex w-100 justify-content-between"},"div_"+e._id),Object(y.jsx)("h5",{children:e.firstname+" "+e.lastname}),Object(y.jsxs)("p",{className:"mb-2",children:["Username: ",e.username]}),Object(y.jsxs)("p",{className:"mb-2",children:["Role: ",e.role.description]})]},"Link_"+e._id)}))})}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No users to show."})}):Object(y.jsx)(w,{})}var H=function(e){var t=Object(s.useState)([]),a=Object(Y.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){N.getUsers().then((function(e){e.data&&n(e.data)}))}),[]),Object(y.jsxs)("div",{className:"mt-2",children:[Object(y.jsxs)("div",{className:"row mb-3",children:[Object(y.jsx)("div",{className:"col-12 text-light",children:Object(y.jsx)("h4",{children:"Manage Approvers"})}),Object(y.jsx)("div",{className:"col",children:Object(y.jsx)(r.b,{to:"/mod/signup",className:"btn btn-outline-light",children:"+ Add approver"})}),Object(y.jsx)("div",{className:"col",children:Object(y.jsx)(r.b,{to:"/mod/roles",className:"btn btn-outline-light",children:"Manage Roles"})})]}),Object(y.jsx)(E,{users:c})]})};var P=function(e){var t=Object(i.g)().state.user,a=Object(s.useState)([]),c=Object(Y.a)(a,2),n=c[0],l=c[1],r=Object(s.useState)(""),o=Object(Y.a)(r,2),d=o[0],j=o[1],m=Object(s.useState)(""),b=Object(Y.a)(m,2),h=b[0],u=b[1],O=Object(s.useState)(""),x=Object(Y.a)(O,2),f=x[0],p=x[1],v=Object(s.useState)(""),g=Object(Y.a)(v,2),w=g[0],C=g[1],k=Object(s.useState)(""),D=Object(Y.a)(k,2),S=D[0],_=D[1],F=Object(s.useState)(!1),A=Object(Y.a)(F,2),q=A[0],T=A[1],M=Object(s.useState)(!1),R=Object(Y.a)(M,2),L=R[0],U=R[1],E=Object(s.useState)(!1),H=Object(Y.a)(E,2),P=H[0],B=H[1];return Object(s.useEffect)((function(){N.getRoles().then((function(e){e.data&&l(e.data)})),j(t.firstname),u(t.lastname),p(t.username),C(t.role._id)}),[]),Object(y.jsx)("div",{className:"container container-form d-flex align-items-center justify-content-center mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:function(e){e.preventDefault(),T(!0);var a={};""===f?(U(!1),T(!1),B(!0)):(B(!1),a=""===S?{id:t._id,username:f,firstname:d,lastname:h,role:w}:{id:t._id,username:f,firstname:d,lastname:h,role:w,password:S},N.updateApprover(a).then((function(){window.location.replace("/mod/users")}),(function(e){T(!1),U(!0)})))},children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[t.firstname," - User Details"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Firstname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:d,onChange:function(e){j(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Lastname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:h,onChange:function(e){u(e.target.value)}})})]}),"mod"==t.role.name?"":Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Username:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:f,onChange:function(e){p(e.target.value)}})})]}),"mod"===t.role.name?"":Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Role:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("select",{type:"text",className:"form-select",value:w,onChange:function(e){C(e.target.value)},children:n.map((function(e){return Object(y.jsxs)("option",{value:e._id,children:[e.name," - ",e.description]})}))})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"New Password:"}),Object(y.jsx)("div",{className:"col-sm-8",value:S,onChange:function(e){_(e.target.value)},children:Object(y.jsx)("input",{type:"password",className:"form-control"})})]}),L?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",P?Object(y.jsx)("strong",{className:"text-danger",children:"Username is required."}):""]}),Object(y.jsx)("div",{className:"card-footer",children:Object(y.jsx)("div",{className:"row",children:Object(y.jsx)("div",{className:"col-12 text-end",children:q?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Update"})})})})]})})},B=a(28);var I=function(e){return Object(y.jsx)(B.a,{show:e.show,dialogClassName:"modal-dialog-centered",children:Object(y.jsxs)("div",{className:"",children:[Object(y.jsx)(B.a.Header,{children:Object(y.jsx)(B.a.Title,{className:"text-danger bg-gradient",children:"Login failed"})}),Object(y.jsx)(B.a.Body,{children:"Please check your username/password."}),Object(y.jsx)(B.a.Footer,{as:"footer",children:Object(y.jsx)("button",{className:"btn btn-outline-dark",onClick:e.hideModal,children:"Close"})})]})})},J=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={username:"",password:"",message:"",role:"",firstname:"",lastname:"",invalidLogin:!1,roles:[]},s.handleSignup=s.handleSignup.bind(Object(v.a)(s)),s.hideModal=s.hideModal.bind(Object(v.a)(s)),s.handleChange=s.handleChange.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getRoles().then((function(t){t.data&&e.setState({roles:t.data})}))}},{key:"handleChange",value:function(e,t){var a=this.state;a[t]=e.target.value,this.setState(a)}},{key:"handleSignup",value:function(e){var t=this;e.preventDefault(),x.register(this.state.username,this.state.firstname,this.state.lastname,this.state.role,this.state.password).then((function(){window.location.replace("users")}),(function(e){t.setState({invalidLogin:!0})}))}},{key:"hideModal",value:function(){this.setState({invalidLogin:!1})}},{key:"render",value:function(){var e=this,t=this.state.roles;return Object(y.jsxs)("div",{className:"container-form mt-5",children:[Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleSignup,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Create new approver"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Username:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"username")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Password:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"password",className:"form-control",onChange:function(t){return e.handleChange(t,"password")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Firstname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"firstname")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Lastname:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"lastname")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Roles:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{className:"form-select",onChange:function(t){return e.handleChange(t,"role")},children:[Object(y.jsx)("option",{selected:!0,value:"",children:"-- role --"}),t.map((function(e){return Object(y.jsxs)("option",{value:e._id,children:[e.name," - ",e.description]})}))]})})]})]}),Object(y.jsx)("div",{className:"card-footer text-end",children:Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]}),Object(y.jsx)(I,{show:this.state.invalidLogin,hideModal:this.hideModal})]})}}]),a}(s.Component);function W(e){return e.roles?0!==e.roles.length?Object(y.jsx)("div",{children:Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.roles.slice(0).reverse().map((function(e){if("mod"!==e.name)return Object(y.jsxs)(r.b,{to:{pathname:"/mod/role/details",state:{role:e}},className:"list-group-item list-group-item-action",children:[Object(y.jsx)("div",{className:"d-flex w-100 justify-content-between"},"div_"+e._id),Object(y.jsx)("h5",{children:e.description}),Object(y.jsxs)("p",{className:"mb-2",children:["Type: ",e.name]}),Object(y.jsxs)("p",{className:"mb-2",children:["Access Level: ",e.level]})]},"Link_"+e._id)}))})}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No roles to show."})}):Object(y.jsx)(w,{})}var z=function(e){var t=Object(s.useState)([]),a=Object(Y.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){N.getRoles().then((function(e){e.data&&n(e.data)}))}),[]),Object(y.jsxs)("div",{className:"mt-2",children:[Object(y.jsxs)("div",{className:"row mb-3",children:[Object(y.jsx)("div",{className:"col-12 text-light",children:Object(y.jsx)("h4",{children:"Roles"})}),Object(y.jsx)("div",{className:"col-4",children:Object(y.jsx)(r.b,{to:"/mod/roles/create",className:"btn btn-outline-light",children:"+ Add role"})}),Object(y.jsx)("div",{className:"col-6",children:Object(y.jsx)(r.b,{to:"/mod/roles/createdepartment",className:"btn btn-outline-light",children:"+ Add department"})})]}),Object(y.jsx)(W,{roles:c})]})},G=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={type:"",description:"",department:"",level:"",clicked_create:!1,error:!1,field_missing:!1,departments:[]},s.handleCreate=s.handleCreate.bind(Object(v.a)(s)),s.handleChange=s.handleChange.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getDepartments().then((function(t){t.data&&e.setState({departments:t.data})}))}},{key:"handleChange",value:function(e,t){var a=this.state;a[t]=e.target.value,this.setState(a)}},{key:"handleCreate",value:function(e){var t=this;e.preventDefault(),this.setState({clicked_create:!0});var a=this.state.type,s=this.state.description,c=this.state.department,n=this.state.level;""===a&&""===n?(this.setState({field_missing:!0}),this.setState({clicked_create:!1})):(this.setState({field_missing:!1}),N.createRole({name:a,description:s,department:c,level:n}).then((function(){t.setState({clicked_create:!1}),window.location.replace("/mod/roles")}),(function(e){t.setState({clicked_create:!1}),t.setState({error:!0})})))}},{key:"render",value:function(){var e=this,t=this.state.departments;return Object(y.jsx)("div",{className:"container-form mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleCreate,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Create new roles"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Type:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{placeholder:"e.g. HOD",type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"type")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Description:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{placeholder:"e.g. Head of IT",type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"description")}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Department:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{className:"form-select",onChange:function(t){return e.handleChange(t,"department")},children:[Object(y.jsx)("option",{selected:!0,value:"",children:"-- department --"}),t.map((function(e){return Object(y.jsx)("option",{value:e._id,children:e.name})}))]})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Access level:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{className:"form-select",onChange:function(t){return e.handleChange(t,"level")},children:[Object(y.jsx)("option",{selected:!0,value:"",children:"-- access level --"}),Object(y.jsx)("option",{value:"0",children:"level 0 -- only view"}),Object(y.jsx)("option",{value:"1",children:"level 1 -- view/approve only department requests"}),Object(y.jsx)("option",{value:"2",children:"level 2 -- view/approve all requests"})]})})]}),this.state.error?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",this.state.field_missing?Object(y.jsx)("strong",{className:"text-danger",children:"Type and Access level fields are required."}):""]}),Object(y.jsx)("div",{className:"card-footer text-end",children:this.state.clicked_create?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]})})}}]),a}(s.Component),K=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={name:"",clicked_create:!1,error:!1,field_missing:!1},s.handleCreate=s.handleCreate.bind(Object(v.a)(s)),s.handleChange=s.handleChange.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e,t){var a=this.state;a[t]=e.target.value,this.setState(a)}},{key:"handleCreate",value:function(e){var t=this;e.preventDefault(),this.setState({clicked_create:!0});var a=this.state.name;""===a?(this.setState({field_missing:!0}),this.setState({clicked_create:!1})):(this.setState({field_missing:!1}),N.createDepartment({name:a}).then((function(){t.setState({clicked_create:!1}),window.location.replace("/mod/roles")}),(function(e){t.setState({clicked_create:!1}),t.setState({error:!0})})))}},{key:"render",value:function(){var e=this;return Object(y.jsx)("div",{className:"container-form mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleCreate,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Add Department"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Name:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){return e.handleChange(t,"name")}})})]}),this.state.error?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",this.state.field_missing?Object(y.jsx)("strong",{className:"text-danger",children:"Name field is required."}):""]}),Object(y.jsx)("div",{className:"card-footer text-end",children:this.state.clicked_create?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]})})}}]),a}(s.Component);var Q=function(e){var t=Object(i.g)().state.role,a=Object(s.useState)([]),c=Object(Y.a)(a,2),n=c[0],l=c[1],r=Object(s.useState)(""),o=Object(Y.a)(r,2),d=o[0],j=o[1],m=Object(s.useState)(""),b=Object(Y.a)(m,2),h=b[0],u=b[1],O=Object(s.useState)(""),x=Object(Y.a)(O,2),f=x[0],p=x[1],v=Object(s.useState)(""),g=Object(Y.a)(v,2),w=g[0],C=g[1],k=Object(s.useState)(!1),D=Object(Y.a)(k,2),S=D[0],_=D[1],F=Object(s.useState)(!1),A=Object(Y.a)(F,2),q=A[0],T=A[1],M=Object(s.useState)(!1),R=Object(Y.a)(M,2),L=R[0],U=R[1];return Object(s.useEffect)((function(){N.getDepartments().then((function(e){e.data&&l(e.data)})),j(t.description),u(t.name),C(t.department),p(t.level)}),[]),Object(y.jsx)("div",{className:"container container-form d-flex align-items-center justify-content-center mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:function(e){if(e.preventDefault(),_(!0),""===f&&""==h)T(!1),_(!1),U(!0);else{U(!1);var a={id:t._id,description:d,level:f,name:h,department:w};N.updateRole(a).then((function(){window.location.replace("/mod/roles")}),(function(e){_(!1),T(!0)}))}},children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[t.description," - Role Details"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Type:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:h,onChange:function(e){u(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Description:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:d,onChange:function(e){j(e.target.value)}})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Department:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{type:"text",className:"form-select",value:w,onChange:function(e){C(e.target.value)},children:[Object(y.jsx)("option",{value:"",children:"none"}),n.map((function(e){return Object(y.jsx)("option",{value:e._id,children:e.name})}))]})})]}),"mod"===t.name?"":Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Access Level:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsxs)("select",{type:"text",className:"form-select",value:f,onChange:function(e){p(e.target.value)},children:[Object(y.jsx)("option",{value:"0",children:"level 0 -- only view"}),Object(y.jsx)("option",{value:"1",children:"level 1 -- view/approve only department requests"}),Object(y.jsx)("option",{value:"2",children:"level 2 -- view/approve all requests"})]})})]}),q?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",L?Object(y.jsx)("strong",{className:"text-danger",children:"Name and Access level is required."}):""]}),Object(y.jsx)("div",{className:"card-footer",children:Object(y.jsx)("div",{className:"row",children:Object(y.jsx)("div",{className:"col-12 text-end",children:S?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Update"})})})})]})})};function V(e){return e.forms?0!==e.forms.length?Object(y.jsx)("div",{children:Object(y.jsx)("div",{className:"list-group request-container overflow-auto",children:e.forms.slice(0).reverse().map((function(e){return Object(y.jsxs)(r.b,{to:{pathname:"/mod/form/details",state:{form:e}},className:"list-group-item list-group-item-action",children:[Object(y.jsx)("div",{className:"d-flex w-100 justify-content-between"},"div_"+e._id),Object(y.jsxs)("h5",{children:["Form Title: ",e.name]}),Object(y.jsxs)("p",{className:"mb-2",children:["Date Created:"," ",_()(e.date_created).format("DD/MM/YYYY - h:mm A")]}),Object(y.jsxs)("p",{className:"mb-2",children:["Final Approvers:"," ",e.finals.map((function(e){return e.firstname+". "}))]}),e.finals.map((function(e){}))]},"Link_"+e._id)}))})}):Object(y.jsx)("div",{className:"card request-container mb-3 ms-1 me-1 mt-5",children:Object(y.jsx)("p",{className:"lead m-2 text-center",children:"No forms to show."})}):Object(y.jsx)(w,{})}var X=function(e){var t=Object(s.useState)([]),a=Object(Y.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){N.getForms().then((function(e){e.data&&n(e.data)}))}),[]),Object(y.jsxs)("div",{className:"mt-2",children:[Object(y.jsxs)("div",{className:"row mb-3",children:[Object(y.jsx)("div",{className:"col-12 text-light",children:Object(y.jsx)("h4",{children:"Manage Forms"})}),Object(y.jsx)("div",{className:"col-4",children:Object(y.jsx)(r.b,{to:"/mod/forms/create",className:"btn btn-outline-light",children:"+ Add form"})})]}),Object(y.jsx)(V,{forms:c})]})};function Z(e){var t=Object(s.useState)({}),a=Object(Y.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){n(e.fields)}),[e.fields]),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-2 col-form-label",children:"Fields:"})," ",Object.keys(c).map((function(t){return Object(y.jsxs)("div",{className:"row m-1 form-text",children:[Object(y.jsxs)("div",{className:"form-floating col-5 mb-1 ps-1",children:[Object(y.jsx)("input",{className:"form-control",type:"text",value:c[t].name,onChange:function(a){return e.handleFieldNameChange(a,t)},placeholder:"Field Name",id:"inputFieldName"}),Object(y.jsx)("label",{htmlFor:"inputFieldName",children:"Field Name"})]}),Object(y.jsxs)("div",{className:"form-floating col-3 mb-1 ps-1",children:[Object(y.jsxs)("select",{className:"form-select",type:"text",value:c[t].type,onChange:function(a){return e.handleFieldTypeChange(a,t)},id:"selectFieldTypes",children:[Object(y.jsx)("option",{value:""}),e.fieldTypes.map((function(e){return Object(y.jsxs)("option",{value:e._id,children:[" ",e.name]},e._id)}))]}),Object(y.jsx)("label",{htmlFor:"selectFieldTypes",children:"Field Type"})]}),Object(y.jsxs)("div",{className:"form-check form-switch col-2 m-auto",children:[Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",name:t,checked:c[t].required,onChange:function(a){e.handleRequiredChange(a,t)}}),Object(y.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Required"})]}),Object(y.jsx)("div",{className:"col-2 m-auto text-end",children:Object(y.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:function(a){return e.handleDelete(a,t)},children:"x"})})]})}))]})}var $=function(e){var t=Object(i.g)().state.form,a=Object(s.useState)([]),c=Object(Y.a)(a,2),n=c[0],l=c[1],r=Object(s.useState)(""),o=Object(Y.a)(r,2),d=o[0],j=o[1],m=Object(s.useState)({}),b=Object(Y.a)(m,2),h=b[0],u=b[1],O=Object(s.useState)([]),x=Object(Y.a)(O,2),v=(x[0],x[1],Object(s.useState)(!1)),g=Object(Y.a)(v,2),w=g[0],C=g[1],k=Object(s.useState)(!1),D=Object(Y.a)(k,2),S=D[0],_=D[1],F=Object(s.useState)(!1),A=Object(Y.a)(F,2),q=A[0],T=A[1];return Object(s.useEffect)((function(){N.getFieldTypes().then((function(e){e.data&&l(e.data)}));var e,a={},s=Object(p.a)(t.fields);try{for(s.s();!(e=s.n()).done;){var c=e.value;a[c._id]=c}}catch(n){s.e(n)}finally{s.f()}u(a),j(t.name)}),[]),Object(y.jsx)("div",{className:"container container-form d-flex align-items-center justify-content-center mt-5",children:Object(y.jsxs)("form",{className:"container-form card bg-light bg-gradient",onSubmit:function(e){e.preventDefault(),C(!0);var a=[],s=!1;if(Object.keys(h).map((function(e){""!==h[e].name&&""!==h[e].type||(console.log("found error!"),s=!0),a.push(h[e])})),""===d||s)_(!1),C(!1),T(!0);else{T(!1);var c={id:t._id,name:d,fields:a};N.updateForm(c).then((function(){window.location.replace("/mod/forms")}),(function(e){C(!1),_(!0)}))}},autoComplete:"off",children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[t.name," - Form Details"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Name:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:d,onChange:function(e){j(e.target.value)}})})]}),Object(y.jsx)(Z,{fields:h,fieldTypes:n,handleFieldTypeChange:function(e,t){h[t].type=e.target.value,u(Object(f.a)({},h))},handleFieldNameChange:function(e,t){h[t].name=e.target.value,u(Object(f.a)({},h))},handleRequiredChange:function(e,t){var a=h,s=!a[t].required;a[t].required=s,u(Object(f.a)({},h))},handleDelete:function(e,t){e.preventDefault(),delete h[t],u(Object(f.a)({},h))}}),Object(y.jsx)("div",{className:"mb-3 row text-center",children:Object(y.jsx)("div",{className:"col-12",children:Object(y.jsx)("button",{className:"btn btn-outline-success btn-sm",onClick:function(e){e.preventDefault();u(Object(f.a)(Object(f.a)({},h),{},{new_field:{name:"",required:!1,type:""}}))},children:"+ Add Field"})})}),S?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",q?Object(y.jsx)("strong",{className:"text-danger",children:"Form name, field names and types are required fields."}):""]}),Object(y.jsx)("div",{className:"card-footer",children:Object(y.jsx)("div",{className:"row",children:Object(y.jsx)("div",{className:"col-12 text-end",children:w?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Update"})})})})]})})};function ee(e){var t=Object(s.useState)({}),a=Object(Y.a)(t,2),c=a[0],n=a[1];return Object(s.useEffect)((function(){n(e.fields)}),[e.fields]),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-2 col-form-label",children:"Fields:"})," ",Object(y.jsxs)("div",{className:"row m-1 form-text",children:[Object(y.jsxs)("div",{className:"form-floating col-5 mb-1 ps-1",children:[Object(y.jsx)("input",{className:"form-control",type:"text",value:"Employee Name",placeholder:"Field Name",id:"inputFieldName",disabled:!0}),Object(y.jsx)("label",{htmlFor:"inputFieldName",children:"Field Name"})]}),Object(y.jsxs)("div",{className:"form-floating col-3 mb-1 ps-1",children:[Object(y.jsx)("select",{className:"form-select",type:"text",id:"selectFieldTypes",disabled:!0,children:Object(y.jsx)("option",{selected:!0,children:"Text"})}),Object(y.jsx)("label",{htmlFor:"selectFieldTypes",children:"Field Type"})]}),Object(y.jsxs)("div",{className:"form-check form-switch col-2 m-auto",children:[Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:!0,disabled:!0}),Object(y.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Required"})]})]}),Object(y.jsxs)("div",{className:"row m-1 form-text",children:[Object(y.jsxs)("div",{className:"form-floating col-5 mb-1 ps-1",children:[Object(y.jsx)("input",{className:"form-control",type:"text",value:"Department",placeholder:"Field Name",id:"inputFieldName",disabled:!0}),Object(y.jsx)("label",{htmlFor:"inputFieldName",children:"Field Name"})]}),Object(y.jsxs)("div",{className:"form-floating col-3 mb-1 ps-1",children:[Object(y.jsx)("select",{className:"form-select",type:"text",id:"selectFieldTypes",disabled:!0,children:Object(y.jsx)("option",{selected:!0,children:"Dropdown"})}),Object(y.jsx)("label",{htmlFor:"selectFieldTypes",children:"Field Type"})]}),Object(y.jsxs)("div",{className:"form-check form-switch col-2 m-auto",children:[Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:!0,disabled:!0}),Object(y.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Required"})]})]}),Object.keys(c).map((function(t){return Object(y.jsxs)("div",{className:"row m-1 form-text",children:[Object(y.jsxs)("div",{className:"form-floating col-5 mb-1 ps-1",children:[Object(y.jsx)("input",{className:"form-control",type:"text",value:c[t].name,onChange:function(a){return e.handleFieldNameChange(a,t)},placeholder:"Field Name",id:"inputFieldName"}),Object(y.jsx)("label",{htmlFor:"inputFieldName",children:"Field Name"})]}),Object(y.jsxs)("div",{className:"form-floating col-3 mb-1 ps-1",children:[Object(y.jsxs)("select",{className:"form-select",type:"text",value:c[t].type,onChange:function(a){return e.handleFieldTypeChange(a,t)},id:"selectFieldTypes",children:[Object(y.jsx)("option",{value:""}),e.fieldTypes.map((function(e){return Object(y.jsxs)("option",{value:e._id,children:[" ",e.name]},e._id)}))]}),Object(y.jsx)("label",{htmlFor:"selectFieldTypes",children:"Field Type"})]}),Object(y.jsxs)("div",{className:"form-check form-switch col-2 m-auto",children:[Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",name:t,checked:c[t].required,onChange:function(a){e.handleRequiredChange(a,t)}}),Object(y.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Required"})]}),Object(y.jsx)("div",{className:"col-2 m-auto text-end",children:Object(y.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:function(a){return e.handleDelete(a,t)},children:"x"})})]})}))]})}var te=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).handleFieldTypeChange=function(e,t){var a=s.state.fields;a[t].type=e.target.value,s.setState({fields:a})},s.handleFieldNameChange=function(e,t){var a=s.state.fields;a[t].name=e.target.value,s.setState({fields:a})},s.handleDelete=function(e,t){e.preventDefault();var a=s.state.fields,c=s.state.counter;delete a[t],s.setState({fields:a}),s.setState({counter:c-1})},s.handleAdd=function(e){e.preventDefault();var t=s.state.fields,a=s.state.counter;t[a]={name:"",required:!1,type:""},console.log(t),s.setState({fields:t}),s.setState({counter:a+1})},s.handleRequiredChange=function(e,t){var a=s.state.fields,c=!a[t].required;a[t].required=c,s.setState({fields:a})},s.handleAddFinalApprover=function(e,t){var a=s.state.final_approvers,c=!a[t];a[t]=c,s.setState({final_approvers:a})},s.state={name:"",clicked_create:!1,error:!1,field_missing:!1,fields:{},fieldTypes:[],final_approvers:{},list_of_approvers:[],counter:0},s.handleCreate=s.handleCreate.bind(Object(v.a)(s)),s.handleFieldTypeChange=s.handleFieldTypeChange.bind(Object(v.a)(s)),s.handleFieldNameChange=s.handleFieldNameChange.bind(Object(v.a)(s)),s.handleDelete=s.handleDelete.bind(Object(v.a)(s)),s.handleAdd=s.handleAdd.bind(Object(v.a)(s)),s.handleAddFinalApprover=s.handleAddFinalApprover.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getFieldTypes().then((function(t){t.data&&(console.log(t.data),e.setState({fieldTypes:t.data}))})),N.getApprovers().then((function(t){if(t.data){var a={};t.data.map((function(e){a[e._id]=!1})),e.setState({final_approvers:a}),e.setState({list_of_approvers:t.data})}}))}},{key:"handleCreate",value:function(e){var t=this;e.preventDefault(),this.setState({clicked_create:!0});var a=this.state.name,s=this.state.fields,c=[],n=!1;if(Object.keys(s).map((function(e){""!==s[e].name&&""!==s[e].type||(console.log("found error!"),n=!0),c.push(s[e])})),""===a||n)this.setState({field_missing:!0}),this.setState({clicked_create:!1});else{this.setState({field_missing:!1});var l=this.state.final_approvers,r=[];Object.keys(l).map((function(e){l[e]&&r.push(e)})),N.createForm({name:a,fields:c,finals:r}).then((function(){t.setState({clicked_create:!1}),window.location.replace("/mod/forms")}),(function(e){t.setState({clicked_create:!1}),t.setState({error:!0})}))}}},{key:"render",value:function(){var e=this;return Object(y.jsx)("div",{className:"container-form mt-5",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleCreate,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Create Form"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Form Title:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:function(t){e.setState({name:t.target.value})}})})]}),Object(y.jsx)(ee,{fields:this.state.fields,fieldTypes:this.state.fieldTypes,handleFieldTypeChange:this.handleFieldTypeChange,handleFieldNameChange:this.handleFieldNameChange,handleRequiredChange:this.handleRequiredChange,handleDelete:this.handleDelete}),Object(y.jsx)("div",{className:"mb-3 row text-center",children:Object(y.jsx)("div",{className:"col-12",children:Object(y.jsx)("button",{className:"btn btn-outline-success btn-sm",onClick:this.handleAdd,children:"+ Add Field"})})}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Final Approvers:"}),Object(y.jsx)("div",{className:"mb-3 row text-center m-1",children:this.state.list_of_approvers.map((function(t){return Object(y.jsxs)("div",{className:"form-check col-6 text-start",children:[Object(y.jsx)("input",{className:"form-check-input",type:"checkbox",checked:e.state.final_approvers[t._id],id:"flexCheckDefault",onChange:function(a){return e.handleAddFinalApprover(a,t._id)}}),Object(y.jsx)("label",{className:"form-check-label",htmlFor:"flexCheckDefault",children:t.firstname+" "+t.lastname+" - "+t.role.description})]})}))})]}),this.state.error?Object(y.jsx)("strong",{className:"text-danger mt-2",children:"Error submitting request. Check connection."}):"",this.state.field_missing?Object(y.jsx)("strong",{className:"text-danger",children:"Name field is required."}):""]}),Object(y.jsx)("div",{className:"card-footer text-end",children:this.state.clicked_create?Object(y.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(y.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Loading..."]}):Object(y.jsx)("button",{className:"btn btn-outline-primary",children:"Create"})})]})})}}]),a}(s.Component);var ae=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={currentUser:x.getCurrentUser(),dbRequests:[],showAll:!1},s.handleShowAll=s.handleShowAll.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;N.getApprovalRequests().then((function(t){if(t.data){var a,s=[],c=Object(p.a)(t.data);try{for(c.s();!(a=c.n()).done;){var n,l=a.value,r=0,i=Object(p.a)(l.approval);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.approver._id===x.getCurrentUser().id&&(r+=o.status)}}catch(d){i.e(d)}finally{i.f()}0===r?s.push(Object(f.a)(Object(f.a)({},l),{},{show:!0})):s.push(Object(f.a)(Object(f.a)({},l),{},{show:!1}))}}catch(d){c.e(d)}finally{c.f()}e.setState({dbRequests:s})}})).catch()}},{key:"handleShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"render",value:function(){this.state.currentUser;return Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{className:"container-fluid",children:Object(y.jsxs)("nav",{className:"row navbar navbar-light bg-dark rounded shadow-lg",children:[Object(y.jsx)("div",{className:"col-4",children:Object(y.jsxs)("p",{className:"navbar-brand text-light mt-1",children:["Welcome, ",x.getCurrentUser().firstname,"!"]})}),Object(y.jsxs)("div",{className:"col text-end",children:[Object(y.jsx)(r.b,{className:"btn btn-outline-light",to:"/",children:"Home"}),Object(y.jsx)(r.b,{to:"/mod/users",className:"btn btn-outline-info ms-2",children:"Manage Approvers"}),Object(y.jsx)(r.b,{to:"/mod/forms",className:"btn btn-outline-info ms-2",children:"Manage Forms"}),Object(y.jsx)("button",{className:"btn btn-outline-danger ms-2",onClick:function(){x.logout(),window.location.replace("/")},children:"Logout"})]})]})}),Object(y.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:Object(y.jsxs)(i.c,{children:[Object(y.jsx)(i.a,{exact:!0,path:"/mod/userdetails",component:function(){return Object(y.jsx)(P,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/role/details",component:function(){return Object(y.jsx)(Q,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/signup",component:function(){return Object(y.jsx)(J,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/users",component:function(){return Object(y.jsx)(H,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/roles",component:function(){return Object(y.jsx)(z,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/forms",component:function(){return Object(y.jsx)(X,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/roles/create",component:function(){return Object(y.jsx)(G,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/form/details",component:function(){return Object(y.jsx)($,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/roles/createdepartment",component:function(){return Object(y.jsx)(K,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/mod/forms/create",component:function(){return Object(y.jsx)(te,{})}})]})})]})}}]),a}(s.Component);var se=function(e){var t=Object(i.f)(),a=Object(i.h)().id,c=Object(s.useState)([]),n=Object(Y.a)(c,2),l=n[0],r=n[1],o=Object(s.useState)(""),d=Object(Y.a)(o,2),j=d[0],m=d[1],b=Object(s.useState)(!1),h=Object(Y.a)(b,2),u=h[0],O=h[1],f=Object(s.useState)(0),p=Object(Y.a)(f,2),v=p[0],g=p[1],C=Object(s.useState)(""),k=Object(Y.a)(C,2),D=k[0],S=k[1];return Object(s.useEffect)((function(){var e=!0,t={id:a,approver:x.getCurrentUser().id};return N.getApprovalRequest(t).then((function(t){t.data&&e&&(r(t.data),t.data.date_submitted&&m(_()(t.data.date_submitted).format("DD/MM/YYYY - h:mm A")),t.data.approval?0===t.data.approval.status?(O(!1),g(0),console.log("Form not approved")):(O(!0),g(t.data.approval.status),S(t.data.approval.comments),console.log("Form already approved!")):(g(-1),console.log("MOD")))})).catch((function(e){return console.log(e)})),function(){e=!1}}),[a],[u],[l]),0===l.length?Object(y.jsx)(w,{}):Object(y.jsxs)("div",{className:"container-fluid",children:[Object(y.jsxs)("nav",{className:"row navbar navbar-light bg-dark rounded shadow-lg",children:[Object(y.jsx)("div",{className:"col-4 text-light",children:Object(y.jsxs)("p",{className:"navbar-brand text-light mt-1",children:["Welcome, ",x.getCurrentUser().firstname,"!"]})}),Object(y.jsxs)("div",{className:"col text-end",children:[Object(y.jsx)("button",{className:"btn btn-outline-light",onClick:function(){t.push("/")},children:"Home"}),Object(y.jsx)("button",{className:"btn btn-outline-danger ms-2",onClick:function(){x.logout(),t.push("/"),window.location.reload()},children:"Logout"})]})]}),Object(y.jsx)("div",{className:"container d-flex align-items-center justify-content-center mt-5",children:Object(y.jsx)("div",{className:"container-form",children:Object(y.jsxs)("form",{className:"card bg-light bg-gradient",children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsxs)("h2",{className:"text-center",children:[l.form.name," - Approval Request"]})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Employee Name:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:l.filled_by,readOnly:!0})})]}),l.fields.map((function(e){return Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsxs)("label",{className:"col-sm-4 col-form-label",children:[e.name,":"]},"label_"+e._id),Object(y.jsx)("div",{className:"col-sm-8",children:"Time Out"===e.name?Object(y.jsx)("input",{type:"text",className:"form-control",value:_()(e.value).format("DD/MM/YYYY - h:mm A"),readOnly:!0},e._id):Object(y.jsx)("input",{type:"text",className:"form-control",value:e.value,readOnly:!0},e._id)})]},"div_"+e._id)})),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Date filled:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:j,readOnly:!0})})]})]}),-1!=v?u?Object(y.jsxs)("div",{className:"card-footer row",children:[Object(y.jsxs)("p",{className:"lead m-2 text-center mb-3",children:["This approval request was"," ",1===v?Object(y.jsx)("strong",{className:"text-success",children:"approved "}):Object(y.jsx)("strong",{className:"text-danger",children:"disapproved "}),"by you."]}),Object(y.jsx)("label",{className:"col-sm-4 col-form-label mb-3",children:"Comments:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",value:D,readOnly:!0})})]}):Object(y.jsxs)("div",{className:"card-footer",children:[Object(y.jsxs)("div",{className:"form-floating mb-3",children:[Object(y.jsx)("textarea",{className:"form-control",placeholder:"comments",id:"floatingTextarea",style:{height:"100px","max-height":"100px"},onChange:function(e){S(e.target.value)}}),Object(y.jsx)("label",{className:"text-muted",htmlFor:"floatingTextarea",children:"Leave a comment here"})]}),Object(y.jsxs)("div",{className:"row",children:[Object(y.jsx)("div",{className:"col-6 text-left",children:Object(y.jsx)("button",{className:"btn btn-outline-danger",onClick:function(e){e.preventDefault();var t={request_id:a,approver:x.getCurrentUser().id,action:2,comments:D};console.log(t),N.updateApproval(t).then((function(){O(!0),g(2)}))},children:"Disapprove"})}),Object(y.jsx)("div",{className:"col-6 text-end",children:Object(y.jsx)("button",{className:"btn btn-outline-success",onClick:function(e){e.preventDefault();var t={request_id:a,approver:x.getCurrentUser().id,action:1,comments:D};N.updateApproval(t).then((function(){O(!0),g(1)}))},children:"Approve"})})]})]}):Object(y.jsx)("div",{children:" MOD"})]})})})]})},ce=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={username:"",password:"",message:"",invalidLogin:!1},s.handleLogin=s.handleLogin.bind(Object(v.a)(s)),s.onChangeUsername=s.onChangeUsername.bind(Object(v.a)(s)),s.onChangePassword=s.onChangePassword.bind(Object(v.a)(s)),s.hideModal=s.hideModal.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleLogin",value:function(e){var t=this;e.preventDefault(),x.login(this.state.username,this.state.password).then((function(){window.location.reload()}),(function(e){t.setState({invalidLogin:!0})}))}},{key:"hideModal",value:function(){this.setState({invalidLogin:!1})}},{key:"render",value:function(){return Object(y.jsxs)("div",{className:"row justify-content-center mt-5",children:[Object(y.jsx)("div",{className:"row justify-content-center text-center",children:Object(y.jsx)("div",{className:"col mb-5",children:Object(y.jsx)(r.b,{to:"/dashboard",className:"btn btn-outline-warning btn-lg",children:"Status Dashboard"})})}),Object(y.jsxs)("div",{className:"container-form ",children:[Object(y.jsxs)("form",{className:"card bg-light bg-gradient",onSubmit:this.handleLogin,children:[Object(y.jsx)("div",{className:"card-header",children:Object(y.jsx)("div",{className:"card-title",children:Object(y.jsx)("h2",{className:"text-center",children:"Approver Login"})})}),Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Username:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"text",className:"form-control",onChange:this.onChangeUsername})})]}),Object(y.jsxs)("div",{className:"mb-3 row",children:[Object(y.jsx)("label",{className:"col-sm-4 col-form-label",children:"Password:"}),Object(y.jsx)("div",{className:"col-sm-8",children:Object(y.jsx)("input",{type:"password",className:"form-control",onChange:this.onChangePassword})})]})]}),Object(y.jsx)("div",{className:"card-footer text-end",children:Object(y.jsx)("button",{className:"btn btn-primary",children:"Login"})})]}),Object(y.jsx)(I,{show:this.state.invalidLogin,hideModal:this.hideModal})]})]})}}]),a}(s.Component);function ne(e){if(e.forms)return Object(y.jsx)("div",{className:"row",children:e.forms.map((function(e){if(0!==e.final_approval)return Object(y.jsx)("div",{className:"col-sm-12 col-md-6 col-lg-6",children:Object(y.jsx)("div",{className:"card m-2",children:Object(y.jsxs)("div",{className:"card-body",children:[Object(y.jsxs)("h5",{className:"card-title",children:["Employee Name: ",e.filled_by]}),Object(y.jsxs)("h6",{className:"card-subtitle mb-2 text-muted",children:["Time Submitted:"," ",_()(e.date_submitted).format("DD/MM/YYYY - h:mm A")]}),Object(y.jsxs)("h6",{className:"card-subtitle mb-2 text-muted",children:["Time of Approval:"," ",_()(e.approval_date).format("DD/MM/YYYY - h:mm A")]}),Object(y.jsxs)("p",{className:"card-text text-muted",children:["Form Type: ",e.form.name]}),Object(y.jsx)("p",{className:"card-text",children:1===e.final_approval?Object(y.jsx)("h4",{children:Object(y.jsx)("span",{className:"badge rounded-pill mb-1 me-2 bg-success",children:"Approved"})}):Object(y.jsx)("h4",{children:Object(y.jsx)("span",{className:"badge rounded-pill mb-1 me-2 bg-danger",children:"Not Approved"})})})]})})})}))})}var le=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;Object(o.a)(this,a),s=t.call(this,e);var c=new Date;return c.setHours(0,0,0,0),s.state={dbRequests:[],showDate:c,fromDate:new Date,toDate:new Date,loading:!0,error:!1},s.handleShowAll=s.handleShowAll.bind(Object(v.a)(s)),s.handleDateChange=s.handleDateChange.bind(Object(v.a)(s)),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.showDate.setHours(0,0,0,0);var e=new Date;e.setDate(e.getDate()+1),this.getRequests()}},{key:"getRequests",value:function(){var e=this;this.setState({error:!1}),this.setState({loading:!0});var t=this.state.showDate,a=this.state.toDate;N.getDateRequests({min_date:t,max_date:a}).then((function(t){t.data&&(e.setState({dbRequests:t.data}),e.setState({loading:!1}))})).catch((function(){e.setState({error:!0})}))}},{key:"handleShowAll",value:function(){this.setState({showAll:!this.state.showAll})}},{key:"handleDateChange",value:function(e){this.getRequests()}},{key:"render",value:function(){var e=this,t=this.state.dbRequests;return Object(y.jsxs)("div",{children:[Object(y.jsx)("div",{className:"container-fluid",children:Object(y.jsxs)("nav",{className:"row navbar justify-content-center text-end pt-4",children:[Object(y.jsxs)("div",{className:"col-sm-6 col-md-5 col-lg-3 mb-2",children:[Object(y.jsx)("label",{className:"form-label text-light h5 me-2",children:"From:"}),Object(y.jsx)(A.a,{disableClock:!0,maxDate:this.state.toDate,value:this.state.showDate,onChange:function(t){t.setHours(0,0,0,0),e.setState({showDate:t})},format:"dd/MM/yyyy"})]}),Object(y.jsxs)("div",{className:"col-sm-6 col-md-5 col-lg-3 mb-2",children:[Object(y.jsx)("label",{className:"form-label text-light h5 me-2",children:"To:"}),Object(y.jsx)(A.a,{disableClock:!0,maxDate:new Date,value:this.state.toDate,onChange:function(t){t.setHours(23,59,59,0),e.setState({toDate:t})},format:"dd/MM/yyyy"})]}),Object(y.jsx)("div",{className:"col-2",children:Object(y.jsx)("button",{className:"btn btn-outline-light",onClick:this.handleDateChange,children:"Show"})}),this.state.error?Object(y.jsx)("strong",{className:"text-danger col mt-4",children:"There was an error fetching requests. Check network connection and refresh page."}):""]})}),Object(y.jsx)("div",{className:" align-items-center mt-4",children:this.state.loading?Object(y.jsx)(w,{}):Object(y.jsx)(ne,{forms:t})})]})}}]),a}(s.Component),re=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={currentUser:null},s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=x.getCurrentUser();e&&this.setState({currentUser:e})}},{key:"render",value:function(){var e=this.state.currentUser;return e?e&&e.role.level?3===e.role.level?Object(y.jsx)("div",{className:"",children:Object(y.jsxs)(i.c,{children:[Object(y.jsx)(i.a,{path:"/",component:function(){return Object(y.jsx)(ae,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/form/:id",component:function(){return Object(y.jsx)(se,{})}})]})}):Object(y.jsx)("div",{className:"",children:Object(y.jsxs)(i.c,{children:[Object(y.jsx)(i.a,{exact:!0,path:"/",component:function(){return Object(y.jsx)(U,{})}}),Object(y.jsx)(i.a,{exact:!0,path:"/form/:id",component:function(){return Object(y.jsx)(se,{})}})]})}):void 0:Object(y.jsx)("div",{className:"App-Container container align-items-center justify-content-center",children:Object(y.jsxs)(i.c,{children:[Object(y.jsx)(i.a,{exact:!0,path:"/dashboard",component:function(){return Object(y.jsx)(le,{})}}),Object(y.jsx)(i.a,{path:"/",component:function(){return Object(y.jsx)(ce,{})}})]})})}}]),a}(s.Component);l.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsxs)(r.a,{children:[Object(y.jsx)(re,{}),Object(y.jsx)(i.c,{children:Object(y.jsx)(i.a,{exact:!0,path:"/dashboard",component:function(){return Object(y.jsx)(le,{})}})})]})}),document.getElementById("root"))},32:function(e,t,a){},42:function(e,t){e.exports={ADDR:""}},57:function(e,t){},68:function(e,t,a){},91:function(e,t){},92:function(e,t){}},[[121,1,2]]]);
//# sourceMappingURL=main.103cf17d.chunk.js.map